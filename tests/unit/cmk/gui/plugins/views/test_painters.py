#!/usr/bin/env python3
# -*- coding: utf-8 -*-
# Copyright (C) 2019 tribe29 GmbH - License: GNU General Public License v2
# This file is part of Checkmk (https://checkmk.com). It is subject to the terms and
# conditions defined in the file COPYING, which is part of this source code package.

import pytest

import cmk.utils.version as cmk_version

from cmk.gui.plugins.views.utils import painter_registry


@pytest.mark.usefixtures("load_plugins", "load_config")
def test_registered_painters():
    painters = painter_registry.keys()
    expected_painters = [
        'aggr_acknowledged',
        'aggr_assumed_state',
        'aggr_group',
        'aggr_hosts',
        'aggr_hosts_services',
        'aggr_icons',
        'aggr_in_downtime',
        'aggr_name',
        'aggr_output',
        'aggr_real_state',
        'aggr_state',
        'aggr_state_num',
        'aggr_treestate',
        'aggr_treestate_boxed',
        'alert_stats_crit',
        'alert_stats_ok',
        'alert_stats_problem',
        'alert_stats_unknown',
        'alert_stats_warn',
        'alias',
        'check_manpage',
        'comment_author',
        'comment_comment',
        'comment_entry_type',
        'comment_expires',
        'comment_id',
        'comment_time',
        'comment_what',
        'crash_exception',
        'crash_ident',
        'crash_time',
        'crash_type',
        'crash_version',
        'downtime_author',
        'downtime_comment',
        'downtime_duration',
        'downtime_end_time',
        'downtime_entry_time',
        'downtime_fixed',
        'downtime_id',
        'downtime_origin',
        'downtime_recurring',
        'downtime_start_time',
        'downtime_type',
        'downtime_what',
        'event_application',
        'event_comment',
        'event_contact',
        'event_contact_groups',
        'event_count',
        'event_effective_contact_groups',
        'event_facility',
        'event_first',
        'event_history_icons',
        'event_host',
        'event_host_in_downtime',
        'event_icons',
        'event_id',
        'event_ipaddress',
        'event_last',
        'event_match_groups',
        'event_owner',
        'event_phase',
        'event_pid',
        'event_priority',
        'event_rule_id',
        'event_sl',
        'event_state',
        'event_text',
        'hg_alias',
        'hg_name',
        'hg_num_hosts_down',
        'hg_num_hosts_pending',
        'hg_num_hosts_unreach',
        'hg_num_hosts_up',
        'hg_num_services',
        'hg_num_services_crit',
        'hg_num_services_ok',
        'hg_num_services_pending',
        'hg_num_services_unknown',
        'hg_num_services_warn',
        'history_addinfo',
        'history_line',
        'history_time',
        'history_what',
        'history_what_explained',
        'history_who',
        'host',
        'host_acknowledged',
        'host_address',
        'host_address_families',
        'host_address_family',
        'host_addresses',
        'host_addresses_additional',
        'host_attempt',
        'host_black',
        'host_check_age',
        'host_check_command',
        'host_check_command_expanded',
        'host_check_duration',
        'host_check_interval',
        'host_check_latency',
        'host_check_type',
        'host_childs',
        'host_comments',
        'host_contact_groups',
        'host_contacts',
        'host_custom_notes',
        'host_custom_variable',
        'host_custom_vars',
        'host_docker_node',
        'host_filename',
        'host_flapping',
        'host_graphs',
        'host_group_memberlist',
        'host_icons',
        'host_in_downtime',
        'host_in_notifper',
        'host_ipv4_address',
        'host_ipv6_address',
        'host_is_active',
        'host_is_stale',
        'host_labels',
        'host_last_notification',
        'host_next_check',
        'host_next_notification',
        'host_normal_interval',
        'host_notification_number',
        'host_notification_postponement_reason',
        'host_notifications_enabled',
        'host_notifper',
        'host_parents',
        'host_perf_data',
        'host_plugin_output',
        'host_pnpgraph',
        'host_retry_interval',
        'host_servicelevel',
        'host_services',
        'host_specific_metric',
        'host_staleness',
        'host_state',
        'host_state_age',
        'host_state_onechar',
        'host_tag_address_family',
        'host_tag_agent',
        'host_tag_piggyback',
        'host_tag_snmp_ds',
        'host_tags',
        'host_tags_with_titles',
        'host_with_state',
        'hostgroup_hosts',
        'inv',
        'inv_hardware',
        'inv_hardware_chassis',
        'inv_hardware_components',
        'inv_hardware_components_backplanes',
        'inv_hardware_components_chassis',
        'inv_hardware_components_containers',
        'inv_hardware_components_fans',
        'inv_hardware_components_modules',
        'inv_hardware_components_others',
        'inv_hardware_components_psus',
        'inv_hardware_components_sensors',
        'inv_hardware_components_stacks',
        'inv_hardware_components_unknowns',
        'inv_hardware_cpu',
        'inv_hardware_cpu_arch',
        'inv_hardware_cpu_bus_speed',
        'inv_hardware_cpu_cache_size',
        'inv_hardware_cpu_cores',
        'inv_hardware_cpu_cores_per_cpu',
        'inv_hardware_cpu_cpu_max_capa',
        'inv_hardware_cpu_cpus',
        'inv_hardware_cpu_entitlement',
        'inv_hardware_cpu_implementation_mode',
        'inv_hardware_cpu_logical_cpus',
        'inv_hardware_cpu_max_speed',
        'inv_hardware_cpu_model',
        'inv_hardware_cpu_sharing_mode',
        'inv_hardware_cpu_smt_threads',
        'inv_hardware_cpu_threads',
        'inv_hardware_cpu_threads_per_cpu',
        'inv_hardware_cpu_voltage',
        'inv_hardware_memory',
        'inv_hardware_memory_arrays',
        'inv_hardware_memory_total_ram_usable',
        'inv_hardware_memory_total_swap',
        'inv_hardware_memory_total_vmalloc',
        'inv_hardware_nwadapter',
        'inv_hardware_storage',
        'inv_hardware_storage_controller',
        'inv_hardware_storage_controller_version',
        'inv_hardware_storage_disks',
        'inv_hardware_system',
        'inv_hardware_system_expresscode',
        'inv_hardware_system_manufacturer',
        'inv_hardware_system_model',
        'inv_hardware_system_model_name',
        'inv_hardware_system_product',
        'inv_hardware_system_serial',
        'inv_hardware_system_serial_number',
        'inv_hardware_video',
        'inv_networking',
        'inv_networking_addresses',
        'inv_networking_available_ethernet_ports',
        'inv_networking_interfaces',
        'inv_networking_routes',
        'inv_networking_total_ethernet_ports',
        'inv_networking_total_interfaces',
        'inv_networking_tunnels',
        'inv_networking_wlan',
        'inv_networking_wlan_controller',
        'inv_networking_wlan_controller_accesspoints',
        'inv_software',
        'inv_software_applications',
        'inv_software_applications_check_mk',
        'inv_software_applications_check_mk_agent_version',
        'inv_software_applications_check_mk_cluster_is_cluster',
        'inv_software_applications_check_mk_cluster_nodes',
        'inv_software_applications_check_mk_host_labels',
        'inv_software_applications_check_mk_num_hosts',
        'inv_software_applications_check_mk_num_services',
        'inv_software_applications_check_mk_sites',
        'inv_software_applications_check_mk_versions',
        'inv_software_applications_citrix',
        'inv_software_applications_citrix_controller',
        'inv_software_applications_citrix_controller_controller_version',
        'inv_software_applications_citrix_vm',
        'inv_software_applications_citrix_vm_agent_version',
        'inv_software_applications_citrix_vm_catalog',
        'inv_software_applications_citrix_vm_desktop_group_name',
        'inv_software_applications_docker',
        'inv_software_applications_docker_container',
        'inv_software_applications_docker_container_networks',
        'inv_software_applications_docker_container_node_name',
        'inv_software_applications_docker_container_ports',
        'inv_software_applications_docker_containers',
        'inv_software_applications_docker_images',
        'inv_software_applications_docker_node_labels',
        'inv_software_applications_docker_num_containers_paused',
        'inv_software_applications_docker_num_containers_running',
        'inv_software_applications_docker_num_containers_stopped',
        'inv_software_applications_docker_num_containers_total',
        'inv_software_applications_docker_num_images',
        'inv_software_applications_docker_registry',
        'inv_software_applications_docker_swarm_manager',
        'inv_software_applications_docker_swarm_node_id',
        'inv_software_applications_docker_swarm_state',
        'inv_software_applications_docker_version',
        'inv_software_applications_fortinet_fortigate_high_availability',
        'inv_software_applications_fortinet_fortisandbox',
        'inv_software_applications_ibm_mq',
        'inv_software_applications_ibm_mq_channels',
        'inv_software_applications_ibm_mq_managers',
        'inv_software_applications_ibm_mq_queues',
        'inv_software_applications_kubernetes_assigned_pods',
        'inv_software_applications_kubernetes_ingresses',
        'inv_software_applications_kubernetes_job_container',
        'inv_software_applications_kubernetes_nodes',
        'inv_software_applications_kubernetes_pod_container',
        'inv_software_applications_kubernetes_pod_info',
        'inv_software_applications_kubernetes_pod_info_dns_policy',
        'inv_software_applications_kubernetes_pod_info_host_ip',
        'inv_software_applications_kubernetes_pod_info_host_network',
        'inv_software_applications_kubernetes_pod_info_node',
        'inv_software_applications_kubernetes_pod_info_pod_ip',
        'inv_software_applications_kubernetes_pod_info_qos_class',
        'inv_software_applications_kubernetes_roles',
        'inv_software_applications_kubernetes_selector',
        'inv_software_applications_kubernetes_service_info',
        'inv_software_applications_kubernetes_service_info_cluster_ip',
        'inv_software_applications_kubernetes_service_info_load_balancer_ip',
        'inv_software_applications_kubernetes_service_info_type',
        'inv_software_applications_mssql',
        'inv_software_applications_mssql_instances',
        'inv_software_applications_oracle',
        'inv_software_applications_oracle_dataguard_stats',
        'inv_software_applications_oracle_instance',
        'inv_software_applications_oracle_pga',
        'inv_software_applications_oracle_recovery_area',
        'inv_software_applications_oracle_sga',
        'inv_software_applications_oracle_systemparameter',
        'inv_software_applications_oracle_tablespaces',
        'inv_software_bios',
        'inv_software_bios_date',
        'inv_software_bios_vendor',
        'inv_software_bios_version',
        'inv_software_configuration',
        'inv_software_configuration_snmp_info',
        'inv_software_configuration_snmp_info_contact',
        'inv_software_configuration_snmp_info_location',
        'inv_software_configuration_snmp_info_name',
        'inv_software_firmware',
        'inv_software_firmware_platform_level',
        'inv_software_firmware_vendor',
        'inv_software_firmware_version',
        'inv_software_kernel_config',
        'inv_software_os',
        'inv_software_os_arch',
        'inv_software_os_install_date',
        'inv_software_os_kernel_version',
        'inv_software_os_name',
        'inv_software_os_service_pack',
        'inv_software_os_service_packs',
        'inv_software_os_type',
        'inv_software_os_vendor',
        'inv_software_os_version',
        'inv_software_packages',
        'invbackplane_description',
        'invbackplane_index',
        'invbackplane_location',
        'invbackplane_manufacturer',
        'invbackplane_model',
        'invbackplane_name',
        'invbackplane_serial',
        'invbackplane_software',
        'invchassis_description',
        'invchassis_index',
        'invchassis_location',
        'invchassis_manufacturer',
        'invchassis_model',
        'invchassis_name',
        'invchassis_serial',
        'invchassis_software',
        'invcmksites_apache',
        'invcmksites_autostart',
        'invcmksites_check_helper_usage',
        'invcmksites_check_mk_helper_usage',
        'invcmksites_checker_helper_usage',
        'invcmksites_cmc',
        'invcmksites_crontab',
        'invcmksites_dcd',
        'invcmksites_fetcher_helper_usage',
        'invcmksites_liveproxyd',
        'invcmksites_livestatus_usage',
        'invcmksites_mkeventd',
        'invcmksites_mknotifyd',
        'invcmksites_nagios',
        'invcmksites_npcd',
        'invcmksites_num_hosts',
        'invcmksites_num_services',
        'invcmksites_rrdcached',
        'invcmksites_site',
        'invcmksites_stunnel',
        'invcmksites_used_version',
        'invcmksites_xinetd',
        'invcmkversions_demo',
        'invcmkversions_edition',
        'invcmkversions_num_sites',
        'invcmkversions_number',
        'invcmkversions_version',
        'invcontainer_description',
        'invcontainer_index',
        'invcontainer_location',
        'invcontainer_manufacturer',
        'invcontainer_model',
        'invcontainer_name',
        'invcontainer_serial',
        'invcontainer_software',
        'invdockercontainers_creation',
        'invdockercontainers_id',
        'invdockercontainers_image',
        'invdockercontainers_labels',
        'invdockercontainers_name',
        'invdockercontainers_status',
        'invdockerimages_amount_containers',
        'invdockerimages_creation',
        'invdockerimages_id',
        'invdockerimages_labels',
        'invdockerimages_repodigests',
        'invdockerimages_repotags',
        'invdockerimages_size',
        'inventory_tree',
        'invfan_description',
        'invfan_index',
        'invfan_location',
        'invfan_manufacturer',
        'invfan_model',
        'invfan_name',
        'invfan_serial',
        'invfan_software',
        'invhist_changed',
        'invhist_delta',
        'invhist_new',
        'invhist_removed',
        'invhist_time',
        'invibmmqchannels_monchl',
        'invibmmqchannels_name',
        'invibmmqchannels_qmgr',
        'invibmmqchannels_status',
        'invibmmqchannels_type',
        'invibmmqmanagers_ha',
        'invibmmqmanagers_instname',
        'invibmmqmanagers_instver',
        'invibmmqmanagers_name',
        'invibmmqmanagers_standby',
        'invibmmqmanagers_status',
        'invibmmqqueues_altered',
        'invibmmqqueues_created',
        'invibmmqqueues_maxdepth',
        'invibmmqqueues_maxmsgl',
        'invibmmqqueues_monq',
        'invibmmqqueues_name',
        'invibmmqqueues_qmgr',
        'invinterface_admin_status',
        'invinterface_alias',
        'invinterface_available',
        'invinterface_description',
        'invinterface_index',
        'invinterface_last_change',
        'invinterface_oper_status',
        'invinterface_phys_address',
        'invinterface_port_type',
        'invinterface_speed',
        'invinterface_vlans',
        'invinterface_vlantype',
        'invkernelconfig_parameter',
        'invkernelconfig_value',
        'invmodule_bootloader',
        'invmodule_description',
        'invmodule_firmware',
        'invmodule_index',
        'invmodule_location',
        'invmodule_manufacturer',
        'invmodule_model',
        'invmodule_name',
        'invmodule_serial',
        'invmodule_software',
        'invmodule_type',
        'invoradataguardstats_db_unique',
        'invoradataguardstats_role',
        'invoradataguardstats_sid',
        'invoradataguardstats_switchover',
        'invorainstance_db_creation_time',
        'invorainstance_db_uptime',
        'invorainstance_logins',
        'invorainstance_logmode',
        'invorainstance_openmode',
        'invorainstance_pname',
        'invorainstance_sid',
        'invorainstance_version',
        'invorapga_aggregate_pga_auto_target',
        'invorapga_aggregate_pga_target_parameter',
        'invorapga_bytes_processed',
        'invorapga_extra_bytes_read_written',
        'invorapga_global_memory_bound',
        'invorapga_maximum_pga_allocated',
        'invorapga_maximum_pga_used_for_auto_workareas',
        'invorapga_maximum_pga_used_for_manual_workareas',
        'invorapga_sid',
        'invorapga_total_freeable_pga_memory',
        'invorapga_total_pga_allocated',
        'invorapga_total_pga_inuse',
        'invorapga_total_pga_used_for_auto_workareas',
        'invorapga_total_pga_used_for_manual_workareas',
        'invorarecoveryarea_flashback',
        'invorarecoveryarea_sid',
        'invorasga_buf_cache_size',
        'invorasga_data_trans_cache_size',
        'invorasga_fixed_size',
        'invorasga_free_mem_avail',
        'invorasga_granule_size',
        'invorasga_in_mem_area_size',
        'invorasga_java_pool_size',
        'invorasga_large_pool_size',
        'invorasga_max_size',
        'invorasga_redo_buffer',
        'invorasga_shared_io_pool_size',
        'invorasga_shared_pool_size',
        'invorasga_sid',
        'invorasga_start_oh_shared_pool',
        'invorasga_streams_pool_size',
        'invorasystemparameter_isdefault',
        'invorasystemparameter_name',
        'invorasystemparameter_sid',
        'invorasystemparameter_value',
        'invoratablespace_autoextensible',
        'invoratablespace_current_size',
        'invoratablespace_free_space',
        'invoratablespace_increment_size',
        'invoratablespace_max_size',
        'invoratablespace_name',
        'invoratablespace_num_increments',
        'invoratablespace_sid',
        'invoratablespace_type',
        'invoratablespace_used_size',
        'invoratablespace_version',
        'invother_description',
        'invother_index',
        'invother_location',
        'invother_manufacturer',
        'invother_model',
        'invother_name',
        'invother_serial',
        'invother_software',
        'invpsu_description',
        'invpsu_index',
        'invpsu_location',
        'invpsu_manufacturer',
        'invpsu_model',
        'invpsu_name',
        'invpsu_serial',
        'invpsu_software',
        'invsensor_description',
        'invsensor_index',
        'invsensor_location',
        'invsensor_manufacturer',
        'invsensor_model',
        'invsensor_name',
        'invsensor_serial',
        'invsensor_software',
        'invstack_description',
        'invstack_index',
        'invstack_location',
        'invstack_manufacturer',
        'invstack_model',
        'invstack_name',
        'invstack_serial',
        'invstack_software',
        'invswpac_arch',
        'invswpac_install_date',
        'invswpac_name',
        'invswpac_package_type',
        'invswpac_package_version',
        'invswpac_path',
        'invswpac_size',
        'invswpac_summary',
        'invswpac_vendor',
        'invswpac_version',
        'invtunnels_index',
        'invtunnels_link_priority',
        'invtunnels_peerip',
        'invtunnels_peername',
        'invtunnels_sourceip',
        'invtunnels_tunnel_interface',
        'invunknown_description',
        'invunknown_index',
        'invunknown_location',
        'invunknown_manufacturer',
        'invunknown_model',
        'invunknown_name',
        'invunknown_serial',
        'invunknown_software',
        'log_attempt',
        'log_command',
        'log_comment',
        'log_contact_name',
        'log_date',
        'log_icon',
        'log_lineno',
        'log_message',
        'log_options',
        'log_plugin_output',
        'log_state',
        'log_state_info',
        'log_state_type',
        'log_time',
        'log_type',
        'log_what',
        'num_problems',
        'num_services',
        'num_services_crit',
        'num_services_ok',
        'num_services_pending',
        'num_services_unknown',
        'num_services_warn',
        'perfometer',
        'service_custom_variable',
        'service_description',
        'service_discovery_check',
        'service_discovery_service',
        'service_discovery_state',
        'service_display_name',
        'service_graphs',
        'service_icons',
        'service_labels',
        'service_specific_metric',
        'service_state',
        'service_tags',
        'service_tags_with_titles',
        'sg_alias',
        'sg_name',
        'sg_num_services',
        'sg_num_services_crit',
        'sg_num_services_ok',
        'sg_num_services_pending',
        'sg_num_services_unknown',
        'sg_num_services_warn',
        'sg_services',
        'site_icon',
        'sitealias',
        'sitename_plain',
        'svc_acknowledged',
        'svc_attempt',
        'svc_check_age',
        'svc_check_cache_info',
        'svc_check_command',
        'svc_check_command_expanded',
        'svc_check_duration',
        'svc_check_interval',
        'svc_check_latency',
        'svc_check_period',
        'svc_check_type',
        'svc_comments',
        'svc_contact_groups',
        'svc_contacts',
        'svc_custom_notes',
        'svc_custom_vars',
        'svc_flapping',
        'svc_group_memberlist',
        'svc_in_downtime',
        'svc_in_notifper',
        'svc_is_active',
        'svc_is_stale',
        'svc_last_notification',
        'svc_last_time_ok',
        'svc_long_plugin_output',
        'svc_metrics',
        'svc_next_check',
        'svc_next_notification',
        'svc_normal_interval',
        'svc_notification_number',
        'svc_notification_postponement_reason',
        'svc_notifications_enabled',
        'svc_notifper',
        'svc_perf_data',
        'svc_perf_val01',
        'svc_perf_val02',
        'svc_perf_val03',
        'svc_perf_val04',
        'svc_perf_val05',
        'svc_perf_val06',
        'svc_perf_val07',
        'svc_perf_val08',
        'svc_perf_val09',
        'svc_perf_val10',
        'svc_plugin_output',
        'svc_pnpgraph',
        'svc_retry_interval',
        'svc_servicelevel',
        'svc_staleness',
        'svc_state_age',
        'wato_folder_abs',
        'wato_folder_plain',
        'wato_folder_rel',
    ]

    if not cmk_version.is_raw_edition():
        expected_painters += [
            'svc_metrics_forecast',
            'svc_metrics_hist',
            'sla_fixed',
            'sla_specific',
            'ntop_host_details',
            'ntop_ports',
            'ntop_protocol_breakdown',
            'ntop_top_peers',
            'deployment_downloaded_hash',
            'deployment_icons',
            'deployment_installed_hash',
            'deployment_last_contact',
            'deployment_last_download',
            'deployment_last_error',
            'deployment_target_hash',
        ]

    if cmk_version.is_managed_edition():
        expected_painters += [
            'host_customer',
            'customer_id',
            'customer_name',
            'customer_num_hosts',
            'customer_num_hosts_down',
            'customer_num_hosts_pending',
            'customer_num_hosts_unreach',
            'customer_num_hosts_up',
            'customer_num_services',
            'customer_num_services_crit',
            'customer_num_services_ok',
            'customer_num_services_pending',
            'customer_num_services_unknown',
            'customer_num_services_warn',
        ]

    assert sorted(painters) == sorted(expected_painters)
